<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pregunlam</title>
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="/public/lobby.css">

</head>
<body>

<div class="container">
    {{#usuario}}

    <header class="header">
        <div class="logo">
            <img src="/public/images/logo.png" alt="logo.png">
            <a href="/lobby">
                <h3>Pregunlam</h3>
            </a>
        </div>
        <div class="welcome">
            <span>Bienvenido, {{nombreCompleto_usuario}}</span>
            <form action="/lobby/logout" method="post">
                <button type="submit" class="logout" id="btnCerrarSesion">Cerrar Sesión</button>
            </form>
        </div>
    </header>

    <main>



        <section class="user-info">
            <div class="avatar">
                <a href="/perfil?id={{id_usuario}}"> <img src="{{img_usuario}}" alt="Avatar"> </a>
            </div>
            <div class="user-data w3-margin">
                <h2 id="datosUsuario">
                    {{userName_usuario}}
                    {{#maxPuntaje_usuario}}
                        <span class="points">{{maxPuntaje_usuario}} puntos</span>
                    {{/maxPuntaje_usuario}}
                    {{^maxPuntaje_usuario}}
                        <span class="points">0 puntos</span>
                    {{/maxPuntaje_usuario}}
                </h2>
            </div>
        </section>

        {{#message}}
            <p style="color: #42a501;">{{message}}</p>
        {{/message}}

        <section class="actions">
            <a href="/jugar">
                <button class="play-button">¡JUGAR!</button>
            </a>
            <a href="/ranking">
                <button class="ranking-button">Ranking</button>
            </a>
            <button class="create-button">¡Crea!</button>
        </section>

        <section class="game-history" id="registroPartidas" style="margin-left: 5em; margin-right: 5em;">
            <table class="w3-center w3-text-white">
                <thead>
                <tr>
                    <th>Partida</th>
                    <th>Puntos</th>
                </tr>
                </thead>
                <tbody>
                {{#partidas}}
                <tr class="partida-row"  style="display: none;" >
                    <td>{{fechaHora_partida}}</td>
                    <td>{{puntaje_partida}}</td>
                </tr>
                {{/partidas}}
                </tbody>
            </table>
            <button id="verMas"  class="see-more" onclick="toggleMostrar()">Ver más</button>

        </section>
    </main>

    {{/usuario}}
    {{> audio.mustache}}
    <footer class="w3-center">
        <div class="footer-container w3-gray">
            <h4 class="w3-text-white"><b>Seguinos</b></h4>
            <div class="footer-icons">
                <ul>
                    <li><a href="#" target="_blank"><i class="fa fa-linkedin fa-2x"></i></a></li>
                    <li><a href="#" target="_blank"><i class="fa fa-instagram fa-2x"></i></a></li>
                    <li><a href="#" target="_blank"><i class="fa fa-twitter fa-2x"></i></a></li>
                </ul>
            </div>
        </div>

        <div class="copyright w3-dark-gray w3-text-white">
            <p>2024 - Grupo 3</p>
        </div>
    </footer>
</div>
</body>

<script >
    // Reproduce el audio al cargar la página
    document.addEventListener("DOMContentLoaded", function() {
        var audio = document.getElementById("background-audio");
        audio.play().catch(function(error) {
            // Manejo de errores si el audio no se reproduce automáticamente
            console.error("No se pudo reproducir el audio: ", error);
        });
    });
    function DisableBackButton() {
        window.history.forward()
    }
    DisableBackButton();
    window.onload = DisableBackButton;
    window.onpageshow = function(evt) { if (evt.persisted) DisableBackButton() }
    window.onunload = function() { void (0) }

    document.addEventListener("DOMContentLoaded", function() {
        let partidas = document.querySelectorAll(".partida-row");
        let mostrarInicial = 3; // Cantidad de partidas a mostrar inicialmente
        let mostrandoMas = false; // Estado para saber si estamos mostrando más o menos

        // Función para mostrar solo las primeras 3 partidas al cargar la página
        function mostrarIniciales() {
            partidas.forEach((partida, index) => {
                partida.style.display = index < mostrarInicial ? "table-row" : "none";
            });
            document.getElementById("verMas").textContent = "Ver más";
            mostrandoMas = false;
        }

        // Llama a la función al cargar
        mostrarIniciales();

        // Función para alternar entre "Ver más" y "Ver menos"
        window.toggleMostrar = function() {
            if (mostrandoMas) {
                // Si se está mostrando más, volvemos a mostrar solo los iniciales
                mostrarIniciales();
            } else {
                // Mostrar todas las partidas
                partidas.forEach(partida => partida.style.display = "table-row");
                document.getElementById("verMas").textContent = "Ver menos";
                mostrandoMas = true;
            }
        };
    });




</script>

</html>